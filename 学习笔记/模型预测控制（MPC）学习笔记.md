#最优化控制

目的：在**约束条件**（如物理控制等）下达到**最优**（具体综合分析）的系统表现

## SISO系统

![image-20240112202158671](C:/Users/李文博/AppData/Roaming/Typora/typora-user-images/image-20240112202158671.png)

- 定义两个指标：
  1. 轨迹追踪角度：$\int_{0}^{t}e^2 \,dt$ ，值越小，系统跟踪能力越强。其中 $r$ 为参考值，$y$ 为输出，有 $e=y-r$
  2. 输入角度：$\int_{0}^{t}u^2 \,dt$  ，值越小，系统能耗越小。其中 $u$ 为输入

- 目标/代价函数(Objective/Cost Function)：$J=\int_{0}^{t}(q\cdot e^2+r\cdot u^2) \,dt$ ，其中$q$，$r$为调节参数

==最优化 = 设计一个控制器u，使得 $J$ 达到最小值==

当 $q\gg r$ 时，表明看重误差e；当 $r\gg g$ 时，表明看重输入u



## MIMO系统

![image-20240112203059367](C:/Users/李文博/AppData/Roaming/Typora/typora-user-images/image-20240112203059367.png)

此处的矩阵 $Q$，$R$ 为调节矩阵，$q_1,q_2,r_1,r_2$为系统的权重系数

一般来说这 $Q$，$R$ 矩阵为对角矩阵，我们调节这两个矩阵的对角的系数，实现对于cost function的调节，最终调到最优。



# 模型预测控制（MPC）学习笔记

## 大致思路

1. 首先要有模型，可以是机理模型，也可以是一个基于数据的模型（例如用神经网络training 一个model出来）
2. 建立它的状态空间表达式（**离散化**），再将离散化u的状态空间表达式使用LQR思想设置一个**损失函数**（通常要最小化这个函数）
3. 将状态空间表达式写成**增量**的形式
4. 通过增量形式改写损失函数和状态方程，可以发现**只通过增量和当前的控制量就可以预测N个状态后的状态量和控制量**。
5. 计算U，使得损失函数的值最小（U应该是**一个序列**，我**们取序列的第一个值，作为控制器当前的输入**，至此完成一个周期的预测工作）



通过模型来预测系统在某一未来时间段内的表现来进行优化控制 ，多用于数位控制，故常采用离散型状态空间表达式：$X_{k+1}=AX_k+BU_k$

![image-20240112210406727](C:/Users/李文博/AppData/Roaming/Typora/typora-user-images/image-20240112210406727.png)

三个步骤：

1. 在k时刻：估计/测量读取当前系统状态 ，并基于 $U_K,U_{K+1} \ldots U_{K+N}$ 来进行最优化控制，**只实施$U_K$**
2. 在k+1时刻：重复上述过程，只是将时间t向后推了一个单位，即**只实施$U_{K+1}$**
3. 像这样每移动一步，进行最优化的计算过程，被称为**滚动优化控制**

注意：在==无约束MPC求解最优控制==的过程中，可以看成是一个==线性规划==问题



## 数学建模推导

### 二次规划

一般形式：$\min J = Z^TQZ+C^TZ$ （二次型+线性），可以使用MATLAB和python等工具求解出最优的控制$Z$。

模型预测控制，是要通过数学的推导，把待求的问题化归为以上的这个最优规划问题。

状态方程：$x(k+1)=Ax(k)+Bu(k)$

![be48ae3fd3e62361fa6f20deca4e897](C:/Users/李文博/Documents/WeChat Files/wxid_4snworp45n6p12/FileStorage/Temp/be48ae3fd3e62361fa6f20deca4e897.jpg)







